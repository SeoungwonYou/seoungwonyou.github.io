{"name":"Seoungwonyou.github.io","tagline":"","body":"#HAProxy Centos 6 설치\r\n\r\n##HAProxy\r\nhaproxy는 오픈 소스 로드 벨런서로서 손쉽게 서비스 이중화가 가능하도록 합니다.  \r\n\r\n**로드 밸런서**   \r\n\r\n\r\n##설치 환경\r\nCentOS release 6.4 (Final)  \r\nhaproxy-1.5.2\r\n\r\n## Link\r\n- HAProxy home page  \r\nhttp://www.haproxy.org/  \r\n- Configuration Manual  \r\nhttp://cbonte.github.io/haproxy-dconv/configuration-1.5.html\r\n\r\n\r\n## 다운로드 및 압축 해제\r\n1. yum install wget gcc gcc-c++ autoconf automake make openssl openssl-devel pcre-devel zlib\r\n2. wget http://www.haproxy.org/download/1.5/src/haproxy-1.5.2.tar.gz\r\n3. tar zxvf haproxy-1.5.2.tar.gz\r\n4. cd haproxy-1.5.2\r\n5. make TARGET=linux2628 USE_PCRE=1 USE_OPENSSL=1 USE_ZLIB=1  \r\n압축이 해제된 haproxy-1.5.2 디렉토리의 **README**　파일을 참고하여 설치합니다.\r\n**target 옵션**\r\n```\r\n  - linux22     for Linux 2.2\r\n  - linux24     for Linux 2.4 and above (default)\r\n  - linux24e    for Linux 2.4 with support for a working epoll (> 0.21)\r\n  - linux26     for Linux 2.6 and above\r\n  - linux2628   for Linux 2.6.28, 3.x, and above (enables splice and tproxy)\r\n  - solaris     for Solaris 8 or 10 (others untested)\r\n  - freebsd     for FreeBSD 5 to 10 (others untested)\r\n  - osx         for Mac OS/X\r\n  - openbsd     for OpenBSD 3.1 to 5.2 (others untested)\r\n  - aix51       for AIX 5.1\r\n  - aix52       for AIX 5.2\r\n  - cygwin      for Cygwin\r\n  - generic     for any other OS or version.\r\n  - custom      to manually adjust every setting\r\n```\r\n\r\n\r\n> uname -a   //현재 OS의 버전 확인.\r\n>Linux lvm01 2.6.32-358.el6.x86_64 #1 SMP Fri Feb 22 00:31:26 UTC 2013 x86_64 x86_64 x86_64 GNU/Linux\r\n```\r\n**빌드 예제**  \r\n> For example, I use this to build for Solaris 8 :  \r\n> `$ make TARGET=solaris CPU=ultrasparc USE_STATIC_PCRE=1`  \r\n>And I build it this way on OpenBSD or FreeBSD :   \r\n> `$ gmake TARGET=freebsd USE_PCRE=1 USE_OPENSSL=1 USE_ZLIB=1`  \r\n>And on a classic Linux with SSL and ZLIB support (eg: Red Hat 5.x) :  \r\n>`$ make TARGET=linux26 USE_PCRE=1 USE_OPENSSL=1 USE_ZLIB=1`  \r\n>And on a recent Linux >= 2.6.28 with SSL and ZLIB support :  \r\n>`$ make TARGET=linux2628 USE_PCRE=1 USE_OPENSSL=1 USE_ZLIB=1`  \r\n>In order to build a 32-bit binary on an x86_64 Linux system with SSL support  \r\n>without support for compression but when OpenSSL requires ZLIB anyway :  \r\n>`$ make TARGET=linux26 ARCH=i386 USE_OPENSSL=1 ADDLIB=-lz`\r\n6. make install\r\n>make install를 실행하면 아래와 같이 설치 위치가 출력됨.\r\n```\r\ninstall -d /usr/local/sbin\r\ninstall haproxy /usr/local/sbin\r\ninstall haproxy-systemd-wrapper /usr/local/sbin\r\ninstall -d /usr/local/share/man/man1\r\ninstall -m 644 doc/haproxy.1 /usr/local/share/man/man1\r\ninstall -d /usr/local/doc/haproxy\r\nfor x in configuration architecture haproxy-en haproxy-fr; do \\\r\n\t\tinstall -m 644 doc/$x.txt /usr/local/doc/haproxy ; \\\r\n\tdone\r\n```\r\n7. cp examples/haproxy.init /etc/init.d/haproxy\r\n7. mkdir /etc/haproxy\r\n8. cp ./examples.cfg  /etc/haproxy/haproxy.cfg\r\n9. vi /etc/haproxy/haproxy.cfg\r\n```\r\nlobal\r\n\tlog 127.0.0.1\tlocal0\r\n\tlog 127.0.0.1\tlocal1 notice\r\n\t#log loghost\tlocal0 info\r\n\tmaxconn 4096\r\n\tchroot /usr/share/haproxy\r\n\tuid 99\r\n\tgid 99\r\n\tdaemon\r\n\t#debug\r\n\t#quiet\r\n\r\ndefaults\r\n\tlog\tglobal\r\n\tmode\thttp\r\n\toption\thttplog\r\n\toption\tdontlognull\r\n    option forwardfor\r\n\tretries\t3\r\n\tmaxconn\t2000\r\n\toption redispatch\r\n    timeout connect      5000\r\n    timeout client      50000\r\n    timeout server      50000\r\n\r\nlisten\tappli1-rewrite 0.0.0.0:80\r\n\tcookie\tSERVERID rewrite\r\n    cookie  JSESSIONID prefix\r\n\tbalance\troundrobin\r\n\tserver\twebserver1 172.16.120.172:80 cookie webserver1 check inter 2000 rise 2 fall 5\r\n\tserver\twebserver2 172.16.120.173:80 cookie webserver2 check inter 2000 rise 2 fall 5\r\nlisten stats :4997\r\n    mode http\r\n    stats enable\r\n    stats hide-version\r\n    stats realm Haproxy\\ Statistics\r\n    stats uri /\r\n    stats auth admin:pwd\r\n```\r\n\r\n## Remote Client 정보\r\nhttp://www.stderr.net/apache/rpaf\r\n\r\n    wget http://www.stderr.net/apache/rpaf/download/mod_rpaf-0.6.tar.gz\r\n\r\n\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}